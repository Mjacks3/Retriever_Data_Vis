<!DOCTYPE html>
<html>
<title>CMX AP Related UMBC Student Analysis</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<!-- styles are here -->
<!--<link href="styles/style2.css" rel="stylesheet" type="text/css"> No file included yet
<link href="c3-0.5.3/c3.css" rel="stylesheet"> -->

<!-- javascript functions goes here
 <script type="text/javascript" src="fusioncharts/js/fusioncharts.js"></script>
 <script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.ocean.js"></script>  -->
<script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDyBxevA7di7Avo5vGKAgPPSkJa8ud4gnI&callback=initMap&libraries=visualization"></script>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.7.1.min.js"></script>



<!-- Include Required Prerequisites -->
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1/jquery.min.js"></script> 
<script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script> 
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap/3/css/bootstrap.css" /> 
 
<!-- Include Date Range Picker -->
<script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script> 
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
 

<script type="text/javascript">

var map, heatmap;
console.log("File Linked!");

function initMap() {
  console.log("Entered InitMap Function");
  map = new google.maps.Map(document.getElementById('map'), {
    zoom: 16.5,
    center: {lat: 39.2558715, lng: -76.7118267},
    mapTypeId: 'satellite'
  });
   
   builds = cmx();
   block = dataGeneration(builds,hour = 0);
   pts  = getPoints(block),
   
   
	heatmap = new google.maps.visualization.HeatmapLayer({
    data: getPoints(block),
    map: map  
	
 })
 changeRadius();
 changeOpacity();
 console.log("Exiting InitMap Function");
}

function cmx() {
	console.log("Entered CMX Function");
    var xhttp = new XMLHttpRequest();
    var restURL= "https://cmx.noc.umbc.edu/api/analytics/v1/deviceCount?"+
        "areas=118%2C185%2C304%2C488%2C587%"+
        "2C629%2C664%2C1025%2C1193%2C1206%2C1210%2C1260%2C1357"+
        "%2C1421%2C1875%2C1880%2C1564%2C1932%2C2354%2C2376%2C2398%2C2477"+
        "%2C2690%2C2713%2C2743%2C2814%2C2915%2C2920%2C66&"+
        "timeRange=00%3A00-11%3A59&"+
        "period=today&"+
		"granularity=hourly&"+
        "durationCategories=0-1440&"+
        "includeStationary=false&"+
        "connectionState=all&"+
        "type=deviceCount&"+
        "_=1520953855762"
        
    xhttp.open("GET",restURL, false,"admin","HiddenFortress1958");
    xhttp.setRequestHeader("Content-type", "application/json");
    xhttp.send();
    // Get the raw header string
    var response = JSON.parse(xhttp.responseText);
	console.log("Output");
	
	var builds; 
	builds = {};
	var ix;
	for (ix = 0; ix < response["results"].length ;ix++)
	{
		var captures;
		captures = [];
		
		var ind;
		for (ind = 0; ind < response["results"][ix]["data"].length ;ind++)
		{
			captures.push(response["results"][ix]["data"][ind]["value"]);
		}
		builds[response["results"][ix]["area"]] = [captures];

	}
	
	builds['Chesapeake'].push([39.2567085,-76.7086843]);
	builds['Public Policy'].push([39.255092,-76.7094311]);
	builds['Administration'].push([39.2533135,-76.7136622]);
	builds['Library'].push([39.25623,-76.7118938]);
	builds['Biology'].push([39.2548479,-76.7122021]);
	builds['Erickson Hall'].push([39.2570091,-76.7096952]);
	builds['Chemistry'].push([39.2548812,-76.7128226]);
	
	builds['Math_Psyc'].push([39.2540944,-76.7125407]);
	builds['Academic IV'].push([39.2536036,-76.7134087]);
	builds['PAHB'].push([39.2552382,-76.7153259]);
	builds['Commons'].push([39.2549006,-76.7109555]);
	builds['Dining Hall'].push([39.255887,-76.7078899]);
	builds['Hillside'].push([39.2578306,-76.7094585]);
	builds['Susquehanna'].push([39.25553,-76.7089886]);
	
	builds['Patapsco'].push([39.2550174,-76.7064426]);
	builds['Patapsco Addition'].push([39.2552908,-76.707214]);
	builds['Engineering'].push([39.2546022,-76.7140627]);
	builds['Fine Arts'].push([39.2549059,-76.7137036]);
	
	builds['Sondheim'].push([39.2534773,-76.7128474]);
	builds['Potomac Hall'].push([39.2560987,-76.707022]);
	
	builds['Walker AVE South'].push([39.2587439,-76.7150462]);
	builds['Harbor Hall'].push([39.2572848,-76.7084016]);
	builds['Physics'].push([39.2543472,-76.7099418]);
	builds['ITE'].push([39.2538416,-76.714377]);
	builds['University Center'].push([39.2543276,-76.7133115]);
	builds['Walker AVE North'].push([39.2592171,-76.713879]);
	builds['Terrace'].push([39.2573399,-76.7112603]);
	builds['RAC'].push([39.2529955,-76.7128026]);
	builds['Westhills'].push([39.2583289,-76.71274]);
	
	console.log(builds);
	console.log("Exiting CMX");
	
	return builds;
}

 function dataGeneration(builds,hour = 0) 
{
	block = [] 
		for (const [key, value] of Object.entries(builds))
		{
			var ind2;
			for (ind2 = 0; ind2 < value[0][hour]; ind2++)
			{
				block.push(value[1])
			}
		}
		console.log(block);
		return block;
}
function toggleHeatmap() {
  heatmap.setMap(heatmap.getMap() ? null : map);
}

function changeGradient() {
  var gradient = [
    'rgba(0, 255, 255, 0)',
    'rgba(0, 255, 255, 1)',
    'rgba(0, 191, 255, 1)',
    'rgba(0, 127, 255, 1)',
    'rgba(0, 63, 255, 1)',
    'rgba(0, 0, 255, 1)',
    'rgba(0, 0, 223, 1)',
    'rgba(0, 0, 191, 1)',
    'rgba(0, 0, 159, 1)',
    'rgba(0, 0, 127, 1)',
    'rgba(63, 0, 91, 1)',
    'rgba(127, 0, 63, 1)',
    'rgba(191, 0, 31, 1)',
    'rgba(255, 0, 0, 1)'
  ]
  heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
}

function changeRadius() {
  heatmap.set('radius', heatmap.get('radius') ? null : 57);
}

function changeOpacity() {
  heatmap.set('opacity', heatmap.get('opacity') ? null : 0.8);
}

function getPoints(block) 
{
	pts = []
	var ind; 
	for (ind = 0;  ind < block.length ; ind++)
	{
		pts.push( new google.maps.LatLng(block[ind][0], block[ind][1]) ) ;
	}
	console.log(pts);
	return pts;
}
</script>

<body class="w3-light-grey">

<!-- Top container -->
<div class="w3-bar w3-top w3-black w3-large" style="z-index:4">
  <button class="w3-bar-item w3-button w3-hide-large w3-hover-none w3-hover-text-light-grey" onclick="w3_open();"><i class="fa fa-bars"></i>  Menu</button>
  <span class="w3-bar-item w3-right">DoitVis</span>
</div>

<!-- Sidebar/menu -->
<nav class="w3-sidebar w3-collapse w3-white w3-animate-left" style="z-index:3;width:300px;" id="mySidebar"><br>
  <div class="w3-container w3-row">
 
  
  <hr>
  <div class="w3-container">
    <h5>Dashboard</h5>
  </div>
  <div class="w3-bar-block">
    <a href="#" class="w3-bar-item w3-button w3-padding-16 w3-hide-large w3-dark-grey w3-hover-black" onclick="w3_close()" title="close menu"><i class="fa fa-remove fa-fw"></i>  Close Menu</a>

    <a href="#" class="w3-bar-item w3-button w3-padding w3-blue"><i class="fa fa-users fa-fw"></i>  Overview</a>

    <hr>
     
     <label class = container> Date Picker </label>
    <div style = "margin-bottom: 5px"> &nbsp&nbsp&nbsp Start Date: &nbsp&nbsp <input type="date" id="startDate"" value="2018-03-22"></div>
  <div> &nbsp&nbsp&nbsp End Date:  &nbsp&nbsp&nbsp&nbsp<input type="date" id="EndDate" " value="2018-03-23"></div>


    

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script type="text/javascript">
      console.log(EndDate.value);
		
    $( function() {
    
		var spinner = $( "#spinner" ).spinner();
		$( "#apply" ).on( "click", function() 
		{
			console.log(spinner.spinner("value"));
		});
		
		$( "button" ).button()
		
		});
		
    </script>
  
  <p>
  <label for="spinner">Select an hour:</label>
  <input id="spinner" name="value">
</p>

<p>
  <button id="apply">Apply Date/Time</button>

 </p>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-eye fa-fw"></i>  Views</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-users fa-fw"></i>  Traffic</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-bullseye fa-fw"></i>  Geo</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-diamond fa-fw"></i>  Orders</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-bell fa-fw"></i>  News</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-bank fa-fw"></i>  General</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-history fa-fw"></i>  History</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-cog fa-fw"></i>  Settings</a><br><br>
  </div>
</nav>


<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:300px;margin-top:43px;">

  <!-- Header -->
  <header class="w3-container" style="padding-top:22px">
    <h5><b><i class="fa fa-dashboard"></i> My Dashboard</b></h5>
  </header>

  <div class="w3-row-padding w3-margin-bottom">
    <div class="w3-quarter">
      <div class="w3-container w3-red w3-padding-16">
        <div class="w3-left"><i class="fa fa-comment w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>52</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Messages</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-blue w3-padding-16">
        <div class="w3-left"><i class="fa fa-eye w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>99</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Views</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-teal w3-padding-16">
        <div class="w3-left"><i class="fa fa-share-alt w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>23</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Shares</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-orange w3-text-white w3-padding-16">
        <div class="w3-left"><i class="fa fa-users w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>50</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Users</h4>
      </div>
    </div>
  </div>

  
    <div class="w3-panel" id="mapPanel">
      <div class="w3-row-padding" style="margin:0 -16px">
        <div class="w3-half">
          <h5>Map</h5>
         
      <div id="map" class="container" style="width:1000px;height:800px" alt="Crime map of Baltimore"</div>
     <!-- <div id="map" class="fill" alt="Crime map of Baltimore"</div> -->
      </div>
      </div>
      </div>
      </div>
<hr>


  <div class="w3-container">
    <h5>Countries</h5>
    <table class="w3-table w3-striped w3-bordered w3-border w3-hoverable w3-white">
      <tr>
        <td>United States</td>
        <td>65%</td>
      </tr>
      <tr>
        <td>UK</td>
        <td>15.7%</td>
      </tr>
      <tr>
        <td>Russia</td>
        <td>5.6%</td>
      </tr>
      <tr>
        <td>Spain</td>
        <td>2.1%</td>
      </tr>
      <tr>
        <td>India</td>
        <td>1.9%</td>
      </tr>
      <tr>
        <td>France</td>
        <td>1.5%</td>
      </tr>
    </table><br>
    <button class="w3-button w3-dark-grey">More Countries  <i class="fa fa-arrow-right"></i></button>
  </div>
  <hr>
  <div class="w3-container">
    <h5>Recent Users</h5>
    <ul class="w3-ul w3-card-4 w3-white">
      <li class="w3-padding-16">
        <!--<img src="/w3images/avatar2.png" class="w3-left w3-circle w3-margin-right" style="width:35px"> No link to file -->
        <span class="w3-xlarge">Mike</span><br>
      </li>
      <li class="w3-padding-16">
        <!--<img src="/w3images/avatar5.png" class="w3-left w3-circle w3-margin-right" style="width:35px"> No link to file -->
        <span class="w3-xlarge">Jill</span><br>
      </li>
      <li class="w3-padding-16">
       <!--  <img src="/w3images/avatar6.png" class="w3-left w3-circle w3-margin-right" style="width:35px"> No link to file -->
        <span class="w3-xlarge">Jane</span><br>
      </li>
    </ul>
  </div>
  <hr>

  

  <!-- Footer -->
  <footer class="w3-container w3-padding-16 w3-light-grey">
    <h4>FOOTER</h4>
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
  </footer>

  <!-- End page content -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
    if (mySidebar.style.display === 'block') {
        mySidebar.style.display = 'none';
        overlayBg.style.display = "none";
    } else {
        mySidebar.style.display = 'block';
        overlayBg.style.display = "block";
    }
}

// Close the sidebar with the close button
function w3_close() {
    mySidebar.style.display = "none";
    overlayBg.style.display = "none";
}
</script>

</body>
</html>
