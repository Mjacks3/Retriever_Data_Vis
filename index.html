<!DOCTYPE html>
<html>
<title>CMX AP Related UMBC Student Analysis</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/drilldown.js"></script>

<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>

<style>
#loading {
   width: 100%;
   height: 100%;
   top: 0;
   left: 0;
   position: fixed;
   display: block;
   opacity: 0.7;
   background-color: #fff;
   z-index: 99;
   text-align: center;
}

#loading-image {
  position: absolute;
  top: 180px;
  left: 475px;
  z-index: 400;
}
</style>
<!-- styles are here -->
<!--<link href="styles/style2.css" rel="stylesheet" type="text/css"> No file included yet
<link href="c3-0.5.3/c3.css" rel="stylesheet"> -->

<!-- javascript functions goes here
 <script type="text/javascript" src="fusioncharts/js/fusioncharts.js"></script>
 <script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.ocean.js"></script>  -->
<script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDyBxevA7di7Avo5vGKAgPPSkJa8ud4gnI&callback=initMap&libraries=visualization"></script>
 
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.7.1.min.js"></script>


 

<script type="text/javascript">

var glbBuilds; 
var glbTotalnts;
var devisenum1;
var dashtotal = 0;

function initMap(start=null, end=null, startHour = 0, endHour = 0) {
  console.log("Entered InitMap Function");
  map = new google.maps.Map(document.getElementById('map'), {
    zoom: 16.5,
    center: {lat: 39.2558715, lng: -76.7118267},
    mapTypeId: 'satellite'
  });
   
   builds = cmx(start, end);
   data = dataGeneration(builds,startHour,endHour);
   
   block = data[0];
   glbTotalnts = data[1];
   devisenum1 = glbTotalnts[0];
   
	heatmap = new google.maps.visualization.HeatmapLayer({
    data: getPoints(block),
    map: map  
	
	
 })
	
 changeRadius();
 changeOpacity();
 console.log("Exiting InitMap Function");
 glbBuilds = builds;
 getdashsum();
getbarcharts();
}
function getValues(){

return glbBuilds;
}
function cmx(start=null, end=null) {
	console.log("Entered CMX Function");
	var mid = "";
	
	if (start == null || end == null)
	{
		start = "to";
		end = "day";
		
	}
	else
	{
		mid = "%3B" ;
	}
    var xhttp = new XMLHttpRequest();
    var restURL= "https://cmx.noc.umbc.edu/api/analytics/v1/deviceCount?"+
        "areas=118%2C185%2C304%2C488%2C587%"+
        "2C629%2C664%2C1025%2C1193%2C1206%2C1210%2C1260%2C1357"+
        "%2C1421%2C1875%2C1880%2C1564%2C1932%2C2354%2C2376%2C2398%2C2477"+
        "%2C2690%2C2713%2C2743%2C2814%2C2915%2C2920%2C66&"+
        "timeRange=00%3A00-23%3A59&"+
        "period="+start +mid+ end+"&"+
		"granularity=hourly&"+
        "durationCategories=0-1440&"+
        "includeStationary=false&"+
        "connectionState=all&"+
        "type=deviceCount&"+
        "_=1520953855762"
        
    xhttp.open("GET",restURL, false,"admin","HiddenFortress1958");
    xhttp.setRequestHeader("Content-type", "application/json");
    xhttp.send();
    // Get the raw header string
    var response = JSON.parse(xhttp.responseText);
	console.log("Output"); 
	
	var builds; 
	builds = {};
	var ix;
	for (ix = 0; ix < response["results"].length ;ix++)
	{
		var captures;
		captures = new Array(24).fill(0);
		
		var ind;
		for (ind = 0; ind < response["results"][ix]["data"].length ;ind++)
		{
			captures[ ind % 24] = captures[ ind % 24] + response["results"][ix]["data"][ind]["value"];
		}
		builds[response["results"][ix]["area"]] = [captures];
	}
	/*
	var jack;
	jack = new Array(24).fill(0);
	console.log(jack);
	console.log( 1 % 24);
	*/
	builds['Chesapeake'].push([39.2567085,-76.7086843]);
	builds['Public Policy'].push([39.255092,-76.7094311]);
	builds['Administration'].push([39.2533135,-76.7136622]);
	builds['Library'].push([39.25623,-76.7118938]);
	builds['Biology'].push([39.2548479,-76.7122021]);
	builds['Erickson Hall'].push([39.2570091,-76.7096952]);
	builds['Chemistry'].push([39.2548812,-76.7128226]);
	
	builds['Math_Psyc'].push([39.2540944,-76.7125407]);
	builds['Academic IV'].push([39.2536036,-76.7134087]);
	builds['PAHB'].push([39.2552382,-76.7153259]);
	builds['Commons'].push([39.2549006,-76.7109555]);
	builds['Dining Hall'].push([39.255887,-76.7078899]);
	builds['Hillside'].push([39.2578306,-76.7094585]);
	builds['Susquehanna'].push([39.25553,-76.7089886]);
	
	builds['Patapsco'].push([39.2550174,-76.7064426]);
	builds['Patapsco Addition'].push([39.2552908,-76.707214]);
	builds['Engineering'].push([39.2546022,-76.7140627]);
	builds['Fine Arts'].push([39.2549059,-76.7137036]);
	
	builds['Sondheim'].push([39.2534773,-76.7128474]);
	builds['Potomac Hall'].push([39.2560987,-76.707022]);
	
	builds['Walker AVE South'].push([39.2587439,-76.7150462]);
	builds['Harbor Hall'].push([39.2572848,-76.7084016]);
	builds['Physics'].push([39.2543472,-76.7099418]);
	builds['ITE'].push([39.2538416,-76.714377]);
	builds['University Center'].push([39.2543276,-76.7133115]);
	builds['Walker AVE North'].push([39.2592171,-76.713879]);
	builds['Terrace'].push([39.2573399,-76.7112603]);
	builds['RAC'].push([39.2529955,-76.7128026]);
	builds['Westhills'].push([39.2583289,-76.71274]);
	
	console.log(builds);
	console.log(Object.keys(builds));
	console.log("Exiting CMX");
	
	return builds;
}

  function dataGeneration(builds, startHour = 0, endHour = 0) 
{

	startHour = new Number( startHour);
	endHour = new Number(endHour);
	
	//return the added block for the chart later
	
	if  ( endHour == 0 ) 
	{
		endHour = 24;
	}	

	if ( startHour > endHour ) 
	{
		alert("Invalid Time fomat");
		return[[],[]];
	}


	if (startHour == endHour) 
	{
	 startHour = 0;
	 endHour = 24;
	}
	
	

	block = [] ;
	totalCounts = [];
		for (const [key, value] of Object.entries(builds))
		{
			var totalBucket = 0;
			var timeslot;
			
			for (timeslot = startHour; timeslot < endHour; timeslot++)
			{
				totalBucket += value[0][timeslot];
			}
			
			totalCounts.push(totalBucket);
			
			var counter; 
			for (counter = 0; counter < totalBucket ; counter ++)
			{
				block.push(value[1]);
			}
			
			
		}
		console.log("Here's what's in block");
		console.log(block);
		return [block,totalCounts] ;
		

}

function toggleHeatmap() {
  heatmap.setMap(heatmap.getMap() ? null : map);
}

function changeGradient() {
  var gradient = [
    'rgba(0, 255, 255, 0)',
    'rgba(0, 255, 255, 1)',
    'rgba(0, 191, 255, 1)',
    'rgba(0, 127, 255, 1)',
    'rgba(0, 63, 255, 1)',
    'rgba(0, 0, 255, 1)',
    'rgba(0, 0, 223, 1)',
    'rgba(0, 0, 191, 1)',
    'rgba(0, 0, 159, 1)',
    'rgba(0, 0, 127, 1)',
    'rgba(63, 0, 91, 1)',
    'rgba(127, 0, 63, 1)',
    'rgba(191, 0, 31, 1)',
    'rgba(255, 0, 0, 1)'
  ]
  heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
}

function changeRadius() {
  heatmap.set('radius', heatmap.get('radius') ? null : 57);
}

function changeOpacity() {
  heatmap.set('opacity', heatmap.get('opacity') ? null : 0.8);
}
function getPoints(block) 
{
	pts = [];
	var ind; 
	for (ind = 0;  ind < block.length ; ind++)
	{
		pts.push( new google.maps.LatLng(block[ind][0], block[ind][1]) ) ;
	}
	return pts;
}


function getbarcharts(){
  Highcharts.chart('barcontainer', {
  chart: {
    type: 'column'
  },
  title: {
    text: 'Devices Number by Areas on Campus'
  },
  subtitle: {
    text: 'Click the columns to view versions. School Website: <a href="https://www.umbc.edu/" target="_blank">umbc.edu</a>'
  },
  xAxis: {
    type: 'category'
  },
  yAxis: {
    title: {
      text: 'Total Number of Devices'
    }

  },
  legend: {
    enabled: false
  },
  plotOptions: {
    series: {
      borderWidth: 0,
      dataLabels: {
        enabled: true,
        format: '{point.y:.1f}'
      }
    }
  },

  tooltip: {
    headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
    pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}</b> Devices<br/>'
  },

  "series": [
    {
      "name": "UMBC Campus",
      "colorByPoint": true,
      "data": [
        {
          "name": "Residential Buildings",
          "y": glbTotalnts[4]+glbTotalnts[8]+glbTotalnts[10]+glbTotalnts[11]+glbTotalnts[16]+glbTotalnts[17]+glbTotalnts[19]+glbTotalnts[23]+glbTotalnts[24]+glbTotalnts[26]+glbTotalnts[27]+glbTotalnts[28],
          "drilldown": "Residential Buildings"
        },
      
        {
          "name": "Academic Buildings",
          "y": glbTotalnts[0]+glbTotalnts[1]+glbTotalnts[2]+glbTotalnts[3]+glbTotalnts[7]+glbTotalnts[9]+glbTotalnts[12]+glbTotalnts[14]+glbTotalnts[15]+glbTotalnts[22]+glbTotalnts[18]+glbTotalnts[20],
          "drilldown": "Academic Buildings"
        },

        {
          "name": "Support Facilities",
          "y": glbTotalnts[21]+glbTotalnts[13]+glbTotalnts[5]+glbTotalnts[25]+glbTotalnts[6],
          "drilldown": "Support Facilities"
        }

      ]
    }
  ],
  "drilldown": {
    "series": [
      {
        "name": "Residential Buildings",
        "id": "Residential Buildings",
        "data": [
          [
            "Chesapeake",
            glbTotalnts[4]
          ],
          [
            "Erickson Hall",
            glbTotalnts[8]
          ],
          [
            "Harbor Hall",
            glbTotalnts[10]
          ],
          [
            "Hillside",
            glbTotalnts[11]
          ],
          [
            "Patapsco",
            glbTotalnts[16]
          ],
     
          [
            "Patapsco Addition",
            glbTotalnts[17]
          ],
          [
            "Potomac",
            glbTotalnts[19]
          ],
          [
            "Susquehanna",
            glbTotalnts[23]
          ],
          [
            "Terrace",
            glbTotalnts[24]
          ],
          [
            "Walker AVE North",
            glbTotalnts[26]
          ],
          [
            "Walker AVE South",
            glbTotalnts[27]
          ],
          [
            "Westhills",
            glbTotalnts[28]
          ]
        ]
      },
      
      {
        "name": "Academic Buildings",
        "id": "Academic Buildings",
        "data": [
          [
            "Academic IV",
            glbTotalnts[0]
          ],
          [
            "Administration Building",
            glbTotalnts[1]
          ],
          [
            "Biology",
            glbTotalnts[2]
          ],
          [
            "Chemistry",
            glbTotalnts[3]
          ],
          [
            "Engineering",
            glbTotalnts[7]
          ],
          [
            "Fine Arts",
            glbTotalnts[9]
          ],
          [
            "ITE",
            glbTotalnts[12]
          ],
          [
            "Math_Psyc",
            glbTotalnts[14]
          ],
          [
            "PAHB",
            glbTotalnts[15]
          ],
          [
            "Sondheim",
            glbTotalnts[22]
          ],
          [
            "Physics",
            glbTotalnts[18]
          ],
          
          [
            "Public Policy",
            glbTotalnts[20]
          ]
        ]
      
      },
      {
        "name": "Support Facilities",
        "id": "Support Facilities",
        "data": [
          [
            "RAC",
            glbTotalnts[21]
          ],
          
          [
            "AOK Library",
            glbTotalnts[13]
          ],
          [
            "Commons",
            glbTotalnts[5]
          ],
          [
            "University Center",
            glbTotalnts[25]
          ],
          [
            "Dinning",
            glbTotalnts[6]
          ]
        ]
      }

    ]
  }
});

    /*Highcharts.chart('bar2container', {
    chart: {
        type: 'column'
    },
    title: {
        text: 'Devices Count for Each Building'
    },
    subtitle: {
        text: 'School Info: <a href="https://www.umbc.edu/">umbc.edu</a>'
    },
    xAxis: {
        type: 'category',  
        labels: {
            rotation: -45,
            style: {
                fontSize: '13px',
                fontFamily: 'Verdana, sans-serif'
            }
        }
    },
    yAxis: {
        min: 0,
        title: {
            text: 'Devices Number by Building'
        }
    },
    legend: {
        enabled: false
    },
    tooltip: {
        pointFormat: 'Devise count: <b>{point.y:.1f}</b>'
    },
    series: [{
        name: 'Devise Number',
        data: [
            ['Academic IV', glbTotalnts[0]],
            ['Administration', glbTotalnts[1]],
            ['Biology', glbTotalnts[2]],
            ['Chemistry', glbTotalnts[3]],
            ['Chesapeake', glbTotalnts[4]],
            ['Commons', glbTotalnts[5]],
            ['Dining Hall', glbTotalnts[6]],
            ['Engineering', glbTotalnts[7]],
            ['Erickson Hall', glbTotalnts[8]],
            ['Fine Arts', glbTotalnts[9]],
            ['Harbor Hall', glbTotalnts[10]],
            ['Hillside', glbTotalnts[11]],
            ['ITE', glbTotalnts[12]],
            ['Library', glbTotalnts[13]],
            ['Math_Psyc', glbTotalnts[14]],
            ['PAHB', glbTotalnts[15]],
            ['Patapsco', glbTotalnts[16]],
            ['Patapsco Addition', glbTotalnts[17]],
            ['Physics', glbTotalnts[18]],
            ['Potomac Hall', glbTotalnts[19]],
            ['Public Policy',glbTotalnts[20]],
            ['RAC', glbTotalnts[21]],
            ['Sondheim', glbTotalnts[22]],
            ['Susquehanna', glbTotalnts[23]],
            ['Terrace',glbTotalnts[24]],
            ['University Center', glbTotalnts[25]],
            ['Walker AVE North', glbTotalnts[26]],
            ['Walker AVE South', glbTotalnts[27]],
            ['Westhills', glbTotalnts[28]]
        ],
        dataLabels: {
            enabled: true,
            rotation: -90,
            color: '#FFFFFF',
            align: 'right',
            format: '{point.y:.1f}', // one decimal
            y: 10, // 10 pixels down from the top
            style: {
                fontSize: '13px',
                fontFamily: 'Verdana, sans-serif'
            }
        }
    }]
});*/


var resareatotal = glbTotalnts[4]+glbTotalnts[8]+glbTotalnts[10]+glbTotalnts[11]+glbTotalnts[16]+glbTotalnts[17]+glbTotalnts[19]+glbTotalnts[23]+glbTotalnts[24]+glbTotalnts[26]+glbTotalnts[27]+glbTotalnts[28];
var resareaper = Math.round(resareatotal/dashtotal*100*100)/100;
var acdareatotal = glbTotalnts[0]+glbTotalnts[1]+glbTotalnts[2]+glbTotalnts[3]+glbTotalnts[7]+glbTotalnts[9]+glbTotalnts[12]+glbTotalnts[14]+glbTotalnts[15]+glbTotalnts[22]+glbTotalnts[18] + glbTotalnts[20];
var acdareaper = Math.round(acdareatotal/dashtotal*10000)/100;
var colors = Highcharts.getOptions().colors,
  categories = [
    "Residential <br /> Buildings",
    "Academic <br /> Buildings",
    "Support <br /> Facilities",
  ],
  data = [
    {
      "y": resareaper,
      "color": colors[0],
      "drilldown": {
        "name": "Residential Buildings",
        "categories": [
          "Chesapeake",
          "Erickson Hall",
          "Harbor Hall",
          "Hillside",
          "Patapsco",
          "Patapsco Addition",
          "Potomac",
          "Susquehanna",
          "Terrace",
          "Walker AVE North",
          "Walker AVE South",
          "Westhills"
        ],
        "data": [
          Math.round(glbTotalnts[4]/dashtotal*10000)/100,
          Math.round(glbTotalnts[8]/dashtotal*10000)/100,
          Math.round(glbTotalnts[10]/dashtotal*10000)/100,
          Math.round(glbTotalnts[11]/dashtotal*10000)/100,
          Math.round(glbTotalnts[16]/dashtotal*10000)/100,
          Math.round(glbTotalnts[17]/dashtotal*10000)/100,
          Math.round(glbTotalnts[19]/dashtotal*10000)/100,
          Math.round(glbTotalnts[23]/dashtotal*10000)/100,
          Math.round(glbTotalnts[24]/dashtotal*10000)/100,
          Math.round(glbTotalnts[26]/dashtotal*10000)/100,
          Math.round(glbTotalnts[27]/dashtotal*10000)/100,
          Math.round(glbTotalnts[28]/dashtotal*10000)/100
        ]
      }
    },
    {
      "y": acdareaper,
      "color": colors[1],
      "drilldown": {
        "name": "Academic Buildings",
        "categories": [
          "Academic IV",
          "Administration Building",
          "Biology",
          "Chemistry",
          "Engineering",
          "Fine Arts",
          "ITE",
          "Math_Psyc",
          "PAHB",
          "Sondheim",
          "Physics",
          "Public Policy"
        ],
        "data": [
          Math.round(glbTotalnts[0]/dashtotal*10000)/100,
          Math.round(glbTotalnts[1]/dashtotal*10000)/100,
          Math.round(glbTotalnts[2]/dashtotal*10000)/100,
          Math.round(glbTotalnts[3]/dashtotal*10000)/100,
          Math.round(glbTotalnts[7]/dashtotal*10000)/100,
          Math.round(glbTotalnts[9]/dashtotal*10000)/100,
          Math.round(glbTotalnts[12]/dashtotal*10000)/100,
          Math.round(glbTotalnts[14]/dashtotal*10000)/100,
          Math.round(glbTotalnts[15]/dashtotal*10000)/100,
          Math.round(glbTotalnts[22]/dashtotal*10000)/100,
         Math.round(glbTotalnts[18]/dashtotal*10000)/100,
         Math.round(glbTotalnts[20]/dashtotal*10000)/100
        ]
      }
    },
    {
      "y": Math.round((glbTotalnts[25]+glbTotalnts[21]+glbTotalnts[13]+glbTotalnts[5]+glbTotalnts[6])/dashtotal*10000)/100 ,
      "color": colors[2],
      "drilldown": {
        "name": "Support Facilities",
        "categories": [
          "University Center",
          "RAC",
          "AOK Library",
          "Commons",
          "Dinning Hall"

        ],
        "data": [
         Math.round(glbTotalnts[25]/dashtotal*10000)/100,
          Math.round(glbTotalnts[21]/dashtotal*10000)/100,
          Math.round(glbTotalnts[13]/dashtotal*10000)/100,
          Math.round(glbTotalnts[5]/dashtotal*10000)/100,
          Math.round(glbTotalnts[6]/dashtotal*10000)/100,
        ]
      }
    },
    
    
    
  ],
  browserData = [],
  versionsData = [],
  i,
  j,
  dataLen = data.length,
  drillDataLen,
  brightness;


// Build the data arrays
for (i = 0; i < dataLen; i += 1) {

  // add browser data
  browserData.push({
    name: categories[i],
    y: data[i].y,
    color: data[i].color
  });

  // add version data
  drillDataLen = data[i].drilldown.data.length;
  for (j = 0; j < drillDataLen; j += 1) {
    brightness = 0.2 - (j / drillDataLen) / 5;
    versionsData.push({
      name: data[i].drilldown.categories[j],
      y: data[i].drilldown.data[j],
      color: Highcharts.Color(data[i].color).brighten(brightness).get()
    });
  }
}

// Create the chart
Highcharts.chart('piecontainer', {
  chart: {
    type: 'pie'
  },
  title: {
    text: 'Devices Count Percentage Pie Chart'
  },
  subtitle: {
    text: 'School Info: <a href="https://www.umbc.edu/" target="_blank">umbc.edu</a>'
  },
  yAxis: {
    title: {
      text: 'Total percent building/area share'
    }
  },
  plotOptions: {
    pie: {
      shadow: false,
      center: ['50%', '50%']
    }
  },
  tooltip: {
    valueSuffix: '%'
  },
  series: [{
    name: 'Areas',
    data: browserData,
    size: '60%',
    dataLabels: {
      formatter: function () {
        return this.y > 5 ? this.point.name : null;
      },
      color: '#ffffff',
      distance: -30
    }
  }, {
    name: 'Buildings',
    data: versionsData,
    size: '80%',
    innerSize: '60%',
    dataLabels: {
      formatter: function () {
        // display only if larger than 1
        return this.y > 1 ? '<b>' + this.point.name + ':</b> ' +
          this.y + '%' : null;
      }
    },
    id: 'versions'
  }],
  responsive: {
    rules: [{
      condition: {
        maxWidth: 400
      },
      chartOptions: {
        series: [{
          id: 'versions',
          dataLabels: {
            enabled: false
          }
        }]
      }
    }]
  }
});

}

function getdashsum(){
  dashtotal = 0;
  for (var i = 0; i < glbTotalnts.length; i++){
    dashtotal += glbTotalnts[i];
  }
  document.getElementById("dashtotal").innerHTML = dashtotal;
  console.log("here");
  console.log(dashtotal);
}

</script>

<body class="w3-light-grey">
<div id="loading">
  <img id="loading-image" src="Loading_icon.gif" alt="Loading..." />
</div>

<!-- Top container -->
<div class="w3-bar w3-top w3-black w3-large" style="z-index:4">
  <button class="w3-bar-item w3-button w3-hide-large w3-hover-none w3-hover-text-light-grey" onclick="w3_open();"><i class="fa fa-bars"></i>  Menu</button>
  <span class="w3-bar-item w3-right">DoitVis</span>
</div>

<!-- Sidebar/menu -->
<nav class="w3-sidebar w3-collapse w3-white w3-animate-left" style="z-index:3;width:300px;" id="mySidebar"><br>
  <div class="w3-container w3-row">
 
  
  <hr>
  <div class="w3-container">
    <h3>Retriever Data Visualization</h3>
	
  </div>
  <div class="w3-bar-block">
    <a href="#" class="w3-bar-item w3-button w3-padding-16 w3-hide-large w3-dark-grey w3-hover-black" onclick="w3_close()" title="close menu"><i class="fa fa-remove fa-fw"></i>  Close Menu</a>

<hr>

    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
     <script type="text/javascript">
		
    $( function() {
    
	
		$( "#apply1" ).on( "click", function() 
		{
		initMap(start= startDate.value, end= EndDate.value, startHour= ((StartTime.value).split(":")[0] ) ,endHour= ( (EndTime.value).split(":")[0] ) );
		//getdashsum();
		//getbarcharts();
    
    });

		
		$( "#apply2" ).on( "click", function() 
		{
			map = new google.maps.Map(document.getElementById('map'), {
				zoom: 16.5,
				center: {lat: 39.2558715, lng: -76.7118267},
				mapTypeId: 'satellite' });
				
			data = dataGeneration(builds,startHour= ((StartTime.value).split(":")[0] ) ,endHour= ( (EndTime.value).split(":")[0] )  );
			
			 block = data[0];
			glbTotalnts = data[1];
			
			heatmap = new google.maps.visualization.HeatmapLayer({
			data: getPoints(block),
			map: map 



				 })
				 
				changeRadius();
				changeOpacity();
		  getdashsum();
       getbarcharts();
       
    
    }

		);
		
		
		
		var spinner = $( "#spinner" ).spinner();
		$( "#apply3" ).on( "click", function() 
		{
		
		if (spinner.spinner("value") != null){
		
			map = new google.maps.Map(document.getElementById('map'), {
				zoom: 16.5,
				center: {lat: 39.2558715, lng: -76.7118267},
				mapTypeId: 'satellite' });

			data = dataGeneration(builds,spinner.spinner("value") - 1, spinner.spinner("value"));
			
			block = data[0];
			glbTotalnts = data[1];
			
			heatmap = new google.maps.visualization.HeatmapLayer({
				data: getPoints(block),
				map: map})
				
			changeRadius();
			changeOpacity();
      getdashsum();
      getbarcharts();
				
				}
		else
		{alert("Invalid Time format");}
		
		});
		
    $('#spinner').spinner('option', 'max', 24);
    $('#spinner').spinner('option', 'min', 1);
		
	$( "button" ).button()});
		
    </script>
    <script type="text/javascript">
    	let today = new Date().toISOString().substr(0, 10);
document.querySelector("#StartDate").value = today;
</script>


    <hr>
     
     <p> <label class = container> <h3> Date Picker </h3> </label></p>
     <div style = "margin-bottom: 5px"> &nbsp&nbsp&nbsp Start Date: &nbsp&nbsp <input id="startDate" type="date"  ></div>
  <div> &nbsp&nbsp&nbsp End Date:  &nbsp&nbsp&nbsp&nbsp<input type="date" id="EndDate" ></div>

  <p>
  <button id="apply1">Generate New Date Stats</button>
</p>
 


  <hr>

	
<p><h3>	<label class = container> Filter Time of Day:</label>  </h3></p>
<p><b>
Choose a time frame 
</b></p>

	<div style = "margin-bottom: 5px"> &nbsp&nbsp&nbsp Start time: &nbsp&nbsp <br> <input type="time" id="StartTime" value="00:00:00"></div>
	<div> &nbsp&nbsp&nbsp End time:  &nbsp&nbsp&nbsp&nbsp&nbsp <br> <input type="time" id="EndTime" value="00:00:00"></div>
	
<p>
  <button id="apply2">View New Time Stats</button>
</p>
  <p><b>
  OR :
</b></p>
 
 
  <p>
 <b> <label for="spinner">Select an hour block:</label></b>
  <input id="spinner" name="value">
</p>

  <button id="apply3">View New Time Stats</button>

    <hr>
  </div>
</nav>


<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:300px;margin-top:43px;">

  <!-- Header -->
  <header class="w3-container" style="padding-top:22px">
    <h5><b><i class="fa fa-dashboard"></i> My Dashboard</b></h5>
  </header>

  <div class="w3-row-padding w3-margin-bottom">
    <div class="w3-quarter">
      <div class="w3-container w3-red w3-padding-16">
        <div class="w3-left"><i class="fa fa-share-alt w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3><span id="dashtotal"></span></p></h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Total Devices Number</h4>
      </div>
    </div>
  </div>

    <!---<div class="w3-quarter">
      <div class="w3-container w3-blue w3-padding-16">
        <div class="w3-left"><i class="fa fa-eye w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>99</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Views</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-teal w3-padding-16">
        <div class="w3-left"><i class="fa fa-share-alt w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>23</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Shares</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-orange w3-text-white w3-padding-16">
        <div class="w3-left"><i class="fa fa-users w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>50</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Users</h4>
      </div>
    </div>
  </div>--->

  
    <div class="w3-panel" id="mapPanel">
      <div class="w3-row-padding" style="margin:0 -16px">
        <div class="w3-half">
          <h5>Map</h5>
         

      <div id="map" class="container" style="width:1000px;height:800px" alt="Crime map of Baltimore">
     <!-- <div id="map" class="fill" alt="Crime map of Baltimore"</div> -->
      </div>
      </div>
      </div>
      </div>
<hr>




<!--<script type="text/javascript">
  // Bar chart
 
  
 $( function() {
 
 
  		$( "#apply4" ).on( "click", function() 
		{
		

console.log(getValues());

 getdashsum(); 
getbarcharts();
                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          




$( "button" ).button()});
</script> </script>

 <div class="w3-container">
<p>
  <button class="w3-button w3-dark-grey" id="apply4" ></i>Show More </button>
</p>
  </div>-->

  <h5>&nbsp Charts</h5>

<div id="barcontainer" style="min-width: 300px; height: 400px; margin: 0 auto"></div>


<!--<div id="bar2container" style="min-width: 300px; height: 400px; margin: 0 auto"></div>-->

<div id="piecontainer" style="min-width: 300px; height: 400px; margin: 0 auto"></div>



  
  

  <!-- Footer 
  <footer class="w3-container w3-padding-16 w3-light-grey">
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
  </footer>

End page content -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
    if (mySidebar.style.display === 'block') {
        mySidebar.style.display = 'none';
        overlayBg.style.display = "none";
    } else {
        mySidebar.style.display = 'block';
        overlayBg.style.display = "block";
    }
}

// Close the sidebar with the close button
function w3_close() {
    mySidebar.style.display = "none";
    overlayBg.style.display = "none";
}
</script>



<script language="javascript" type="text/javascript">
     $(window).load(function() {
     $('#loading').hide();
  });
</script>



</body>
</html>
